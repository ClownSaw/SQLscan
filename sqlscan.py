# Fecha: 02/12/2020
# Autor: ClownSaw
# Herramienta: SQLscan
"""Herramienta en Python3, su funci√≥n es buscar sitios web vulnerables a SQL su busqueda
   se ara con DORKS..... La herramientas es efectiva y puedes usarse en los sistemas 
   Windows, Linux, Mac OS y Android (Termux). Espero y les guste!!! y si tienen algun 
   inconveniente pueden escribirnos por Instagram: @clown_saw y con gusto les atenderemos
   FELIZ NAVIDAD!!!!

((%#%#%%%#%#(%(#%%%%%%%%%##%((###(%(%%%#%&%%%%%%&&&%%###(%%%%%%#%(%%%#######(///
/(#((#%%%##%#&&&&%#%#%%&&%%((/#((((#%#%%%%&@%%%&@&%&%&##%#%%%%%%##%%%##%#%%%%###
*%#/###%#&&%&%%%%%&&@@@@,,/&(((*//%%#%%%%&%%&&&@&%%%/,, .@@@&&&%%%&&#&(#&(#(((((
((%#((%#%%#%(%&@@@@..... . ./*/(/(##%&%&&%&&&&&%%&*/******/,, @@@&&%%#%&&&#%%#%#
/(%%%(&&#%%%%&@.             .*###/%%&&&&&%&&&%#&,**,,***,/***,/. @@&&%%%&#&#&%&
%%%%&@&%###@.                 ,/#((%%%%&&%%@%%%*,,.          ...,,,./@&&%%&@%&&&
####%%%%#&                      ./%#%%%&&%%%#&,,                 ...,. @&%%&#&&%
%%%&&&&@@                        //((%%%%%%%%(                      .,,.@@&&%%%#
(%%%&&@@                            ,*,/,,*,      .             .     .,,@@&&&&%
%%&&@&@                                                               ..,.@%%%&&
#&%&&@                                                           .     .,. @&%%&
##%&%@    .                                                             *.,@%%%%
%%%%%@   .                                                              ,,,@&%&&
%#%%%@   .                                                             ,,,,@&%&&
%%#@%@   .                                                            .#*,,@&@&&
%%%%%@   (                                    .                       .*,* @%&%&
#%%%&@/  ,   .                                                       .,**,&&&&@&
(%%%&&@   .    ..,,     ,                                    ,.*,..,,,/,, @&&&&%
###%%&@@ ,#.          .                                  ..         .,#*.@%&%%%&
((%#%%#@**.            @ .                             . @          .,*,*@&&%%%%
((%&@&##@..    ,%     (@   ..                            @      **...*,*@&&%@&&#
###&@   @         *   @       .,                 .       .@   *      **,@/, @&&%
&%&&@ . @          .* @          .,,.      .,            .@ /        ,,.@,* @&&&
##&%@  *.#           /@       .     (       /     .       @*      ..,,,@(#  @%#%
%%#%%& ..@@...,,,*,   @@&           .                   #@@  ,*,,/***,@@/* @%%%%
###&#@. ..@@  .%#@%%@@@@@ *%        *       .       ,(( @@@@@&@@#/.  @@/,.*@%&%#
,@#((#@ .,&.    ,#@&@ # /..,%(@@#**%**,&&%***&**&@@/&* /*.@ &&@#*  . .@,  @##((@
,*%#%/,@,@/  .  . .#&@@@@&&@@@@@#***/       **//%@@@@&&&@@@@&#,       #@,@*/@#&/
%#((##/,@@.       .,*,@@,//*#. /.   ,       *,****,**.,,*@@./.      ..(@@*(%(###
 *@//(&#.@         %@@%             ,       */,**,.  .    @@@*       .,@.%%/((%/
,/(&(%*,,@        @@(               .       ,****,          @@@      . @,,*@(##(
.*(##%#*.,(       #%                        .,*,,..          &@      .@..*##(#//
,,/(%###/.@       @@        ...(%%&@@&@@@@@@@@@&&.,.        .@@    ..*%,/##(%#(*
,,((#@#(@*.*@      @@*   ,&,.  ((@@@@&@@@@@@@@@@@,*,/*%.   #@@   .,,@/.*@((%%##(
*%./(@#%((,.*@@   ..,@@@*...      ..,/@@@@@****,   ..,,**@@@****,,@@/.,(###@/,.#
..,*(&#%%#(/.,/@%    ,**#@@@          %,*,#*.        @@@/**,,,,,@@(.,*//(#%%%*,.
*#/(***%%#/****((@.   .,, #@@@#@@@@@&@@   #&@@@@@@/@@@* ... ..(@/#***/*(&%/**/(#
...*@#(%((#//,.../(@    ,. .@@&.@  @   /@.   @  @,%@@. ..  . @##,.,//#(#@&((@,..
*(*#,/*/#((##@/,*.,(#@       @@##@ @    @   .@ @%&@@.    ..@#(,,**(@(#(/((,#.&//
.....,*/*/###%(*...,/(@       @@#,%#@. .@ #@@%&@@@@.    .,@##....*(#(%#/***/....
**.**..,*#((&/%##/,..*(@        @@@&#@@&&@@@&#@@@*.  . ..%#/..,/((#(%#(/*...*/,*
((/*/*//,*,*%(((((/#...##    .,  .@@@@@@@@@@@@@*/***. .*#(...%///(((@/,,,%(/*/((
@((///%*,/****/%#(@/,,../#@      .   .*****..,.,,,.  .@#/..,,/@(/#(/*/****(/((##
*##@#(*/((.,.#/#(#(#%@/*.*//@                      .@/**.**%#((%##/#../(/**(%&%#
#%.(#%#%(/#%....(((#(((//(*(//@        ...      ..@//(/#//(###%/(./..//((&#%#%.%
,*(&(#%@%%(*@,,.#.,#*&/*@((*/@#(@@@@@&(%@%(@@@@@@(/#/((/@#(#/@,/%(..&(#%(@%((##*
"""
 

from lib.sql import SQL 
from lib.display import Display
from argparse import ArgumentParser


class Engine(object):

    def __init__(self, dork, write_over): 
        self.dork = dork 
        self.display = Display() 
        self.sql = SQL(dork, write_over) 

    def start(self):        
        self.display.banner()
        self.display.primary('Dork: ' + self.dork)

        try: 
            self.sql.start() 
        except KeyboardInterrupt:
            pass 
        finally:
            self.stop()
    
    def stop(self):
            
        if self.sql:
            self.sql.stop()
        else:
            self.display.shutdown()

def args():
    args = ArgumentParser()
    args.add_argument('-d', '--dork', required=True, help='Dork para buscar ejemplo: product.php?id=')
    args.add_argument('-w', '--write-over', dest='writeover', default=False, action='store_true', help='Escribir sobre el archivo de registro existente')
    return args.parse_args()    


if __name__ == '__main__':
    arugments = args()    
    Engine(arugments.dork, arugments.writeover).start()  